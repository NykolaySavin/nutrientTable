<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <!-- Latest compiled and minified CSS -->

    <link rel="stylesheet" href="styles.css" type="text/css" />
  </head>
  <body>
    <div class="inputContainer" id="inputContainer">
      <h1>Select program:</h1>
      <label>
        <select id="substance">
          <option selected="selected">Soil</option>
          <option>Coco</option>
          <option>Hydro</option>
        </select>
      </label>
      <h1>Reservoir size:</h1>
      <input name="amount" type="number" />
      <h1>Measurement:</h1>
      <label>
        <select id="footage">
          <option selected="selected">Gallons</option>
          <option>Litres</option>
        </select>
      </label>
    </div>
    <div class="inputContainer">
      <a class="button" id="addGreenColumn">Add Veg Week</a>
      <a class="button" id="removeGreenColumn">Remove Veg Week</a>
      <a class="button" id="addRedColumn">Add Flower Week</a>
      <a class="button" id="removeRedColumn">Remove Flower Week</a>
      <a class="button" id="printTable">Print</a>
    </div>
    <div id="greenContent"></div>
    <div id="redContent"></div>
    <script type="text/javascript">
      let greenColumns = 6;
      let redColumns = 8;
      let value = 0;
      let substance = "Soil";
      let footage = "Gallons";
      const tFooterGreen =["300-500","500-750","750-950","950-1050","1050-1200","1200-1400","1200-1400","1200-1400","1200-1400","1200-1400","1200-1400"];

      const tFooterRed =["850-950","1000-1200","1200-1350","1350-1500","1600-1700","1500-1650","1400-1500","1250-1400","1250-1400","1250-1400","1250-1400","1250-1400","1250-1400","1250-1400"];
      const hydroGreen = [
        [6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [10, 12, 14, 14, 14, 14, 14, 14, 14, 14],
        [3, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5],
        [6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
        [7, 9, 9, 9, 9, 11, 11, 11, 11, 11],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [5, 5, 10, 10, 10, 11, 11, 11, 11, 11]
      ];
      const cocoGreen = [
        [6, 8, 8, 8, 9, 10, 10, 10, 10, 10],
        [10, 12, 15, 17, 17, 19, 19, 19, 19, 19],
        [4, 5, 5, 5, 6, 6, 6, 6, 6, 6],
        [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [7, 9, 9, 9, 9, 11, 11, 11, 11, 11, 11],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [7, 7, 10, 10, 10, 14, 14, 14, 14, 14, 14, 14],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
      ];
      const soilGreen = [
        [6, 8, 8, 8, 9, 10, 10, 10, 10, 10],
        [10, 12, 15, 17, 17, 19, 19, 19, 19, 19],
        [4, 5, 5, 5, 6, 6, 6, 6, 6, 6],
        ["", "", "", "", "", "", "", "", "", ""],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [7, 9, 9, 9, 9, 11, 11, 11, 11, 11, 11],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        [7, 7, 10, 10, 10, 14, 14, 14, 14, 14, 14, 14],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
      ];
      const cocoRed = [
        [6, 7, 7, 8, 8, 7, 6, 6, 6, 6, 6, 6, 6, 6],
        [5, 4, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1],
        [9, 11, 11, 15, 17, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21],
        [2.5, 2.5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [14, 10, 7, 7, "", "", "", "", "", "", "", "", "", ""],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        ["", 6, 8, "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", 8, 8, "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", 8, 8, 8, 8, 8, 8, 8, 8, 8]
      ];
      const soilRed = [
        [6, 7, 7, 8, 8, 7, 6, 6, 6, 6, 6, 6, 6, 6],
        [5, 4, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1],
        [9, 11, 11, 15, 17, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21],
        [2.5, 2.5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [14, 10, 7, 7, "", "", "", "", "", "", "", "", "", ""],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        ["", 6, 8, "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", 8, 8, "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", 8, 8, 8, 8, 8, 8, 8, 8, 8]
      ];
      const hydroRed = [
        [6, 7, 7, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6],
        [3, 3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1],
        [9, 9, 9, 17, 17, 19, 21, 21, 21, 21, 21, 21, 21, 21],
        [2.5, 2.5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11],
        [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
        [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
        [11, 10, 5, 5, "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", 6, 8, "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", 8, 8, "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", 8, 8, 8, "", "", "", "", "", ""]
      ];
      function createTable(
        columnLength,
        multiplyValue,
        tableData,
        containerName,
        header,
        tFooterData
      ) {
        var table = $(
          '<table cellpadding="0" cellspacing="0" border="0"></table>'
        ).addClass(containerName);
        thHeader = $("<tr></tr>");
        thHeader.append($("<th></th>"));
        var rowHeader = $("<th></th>")
          .attr("colspan", columnLength)
          .text(header);
        thHeader.append(rowHeader);
        table.append(thHeader);
        weekRow = $("<tr></tr>");
        weekRow.append($("<td></td>"));
        for (var j = 0; j < columnLength; j++) {
          var rowData = $("<td></td>").text("Week " + (j + 1));
          weekRow.append(rowData);
        }
        table.append(weekRow);
        for (var i = 0; i < tableData.length; i++) {
          row = $("<tr></tr>");
          let data = "";
          if (i == 0) data = "MICRO";
          if (i == 1) data = "GROW";
          if (i == 2) data = "BLOOM";
          if (i == 3 && (substance != "Soil" || containerName == "redContent"))
            data = "CALNESIUM";
          if (i == 3 && substance == "Soil" && containerName == "greenContent")
            i++;
          if (i == 4) data = "SUPER B+";
          if (i == 5) data = "ROYAL GOLD";
          if (i == 6) data = "PLANTACILLIN";
          if (i == 7) data = "CARBO BLAST";
          if (i == 8) data = "PROP-O-GATOR";
          if (i == 9 && (substance == "Soil" || substance == "Coco"))
            data = "ROYAL BLACK";
          if (i == 9 && substance == "Hydro") i++;
          if (i == 10) data = "BUD START";
          if (i == 11) data = "TON O BUD";
          if (i == 12) data = "BUD BOOM";
          row.append($("<td></td>").text(data));
          for (var j = 0; j < columnLength; j++) {
            var rowData = $("<td></td>").text(
              Math.floor(tableData[i][j] * multiplyValue * 10) / 10
            );
            row.append(rowData);
          }
          table.append(row);
        }
        var tFooter =$("<tr></tr>").addClass("clear");
        tFooter.append($("<td>Suggested PPM Range</td>"));
        for(var j=0; j<columnLength;j++){
            var rowData = $("<td></td>").text(tFooterData[j]);
            tFooter.append(rowData);
        }

        table.append(tFooter);
        $("#" + containerName).append(table);
      }
      function redrawTables() {
        $("table").remove();
        const currentValue = value ? value : 1;
        const tableDataGreen =
          substance == "Soil"
            ? soilGreen
            : substance == "Coco"
            ? cocoGreen
            : hydroGreen;
        const tableDataRed =
          substance == "Soil"
            ? soilRed
            : substance == "Coco"
            ? cocoRed
            : hydroRed;
        const multiplier =
          footage == "Gallons" ? currentValue : currentValue / 3.785;

        createTable(
          greenColumns,
          multiplier,
          tableDataGreen,
          "greenContent",
          "VEGETATIVE STAGE",
            tFooterGreen
        );
        createTable(
          redColumns,
          multiplier,
          tableDataRed,
          "redContent",
          "FLOWERING & RIPENING STAGE",
            tFooterRed
        );
      }
      $(function() {
        $("#addGreenColumn").click(() => {
          if (greenColumns < 10) {
            greenColumns++;
            redrawTables();
          }
        });
      });
      $(function() {
        $("#removeGreenColumn").click(() => {
          if (greenColumns > 3) {
            greenColumns--;
            redrawTables();
          }
        });
      });
      $(function() {
        $("#addRedColumn").click(() => {
          if (redColumns < 14) {
            redColumns++;
            redrawTables();
          }
        });
      });
      $(function() {
        $("#removeRedColumn").click(() => {
          if (redColumns > 6) {
            redColumns--;
            redrawTables();
          }
        });
      });
      $("input[name=amount]").keyup(e => {
        value = e.target.value;
        redrawTables();
      });
      $("#substance").on("change", function() {
        substance = this.value;
        redrawTables();
      });
      $("#footage").on("change", function() {
        footage = this.value;
        redrawTables();
      });
      $("#printTable").click(() => printDiv());
      function printDiv() {
        var greenDiv = document.getElementById("greenContent");
        var redDiv = document.getElementById("redContent");
        var inputDiv = document.getElementById("inputContainer");
        var newWin = window.open("", "Print-Window");

        newWin.document.open();

        newWin.document.write(
          '<html><head><link rel="stylesheet" href="styles.css" type="text/css" media="print" /></head><body onload="window.print()">' +
            inputDiv.innerHTML +
            greenDiv.innerHTML +
            redDiv.innerHTML +
            "</body></html>"
        );

        newWin.document.close();

        setTimeout(function() {
          newWin.close();
        }, 10);
      }
      redrawTables();
    </script>
  </body>
</html>
